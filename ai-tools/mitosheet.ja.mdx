---
title: "Mitosheet | ExcelでPythonコードを自動生成 | Jupyter NotebookでExcelスプレッドシートを使用する"
description: "革新的なツールであるMitosheetに深く入り込み、JupyterLabとStreamlitにシームレスに統合します。このガイドでは、インストールから高度な機能まで、すべてをカバーしています。データサイエンスのゲームを進化させる準備をしましょう！"
language: ja
date: 2023-12-17
author: lynn
ogImage: https://github.com/lynn-mikami/Images/blob/main/mitosheet-ogImage.png?raw=true
---

# Mitosheet: Excel for Python? Jupyter Notebookでスプレッドシートを扱う

import BlogHeader from '../../components/blog-header';

<BlogHeader />

データサイエンスは常に進化しており、データの操作、分析、可視化に対応できる多目的なツールが求められています。Jupyterノートブックは多くの人にとって頼りになるプラットフォームですが、データサイエンティストにとって仕事を簡単にするための専門ツールを追加するスペースが常にあります。Mitosheetは、JupyterLabとStreamlit環境でスプレッドシートのパワーをもたらす画期的なツールです。この記事では、Mitosheetの理解、機能、およびデータサイエンスのワークフローに統合する方法について、包括的なガイドを提供します。

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">This is gonna change Data Analytics forever!Introducing Mitosheets! 🚀Run spreadsheets inside your Jupyter Notebook &amp; generate production-ready Python code for all the edits that you make!Check this out👇 <a href="https://t.co/vD5wFgd8PC">pic.twitter.com/vD5wFgd8PC</a></p>&mdash; Akshay 🚀 (@akshay_pachaar) <a href="https://twitter.com/akshay_pachaar/status/1712808057712030166?ref_src=twsrc%5Etfw">October 13, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

経験豊富なデータサイエンティストであるか、実世界のデータで手を汚すことを初めてする初心者であっても、Mitosheetは作業を簡素化できるさまざまな機能を提供します。ツールのインストールから高度な機能まで、このガイドではすべてをカバーしています。さあ、始めましょう！

## Mitosheetとは？

**Mitosheet**は、JupyterLabとStreamlitアプリケーション内で動作する動的なツールです。スプレッドシートのようなインターフェースでPandasのデータフレームを操作できるようにし、従来のスプレッドシートとPythonベースのデータ分析とのギャップを埋めることができます。しかし、Mitosheetの特徴的な点は、スプレッドシートで行った編集に対応するPythonコードを生成する機能です。これにより、単に孤立した状態で作業しているだけでなく、大きなPythonプロジェクトに組み込むことができる再利用可能なコードを作成することができます。

### Mitosheetの革新点

- **使いやすさ**：Mitosheetの直感的なインターフェースは、Pythonやデータサイエンスに初めて触れる人にもアクセスしやすくなっています。
- **コード生成**：Mitosheetで行うすべての操作は、通常はPandasライブラリを使用したPythonコードを生成します。このコードはプロダクションに使用でき、プロジェクトの他の部分で使用することができます。
- **互換性**：MitosheetはPythonと非常に互換性があり、既存のJupyterノートブックやStreamlitアプリにシームレスに統合されます。

### Mitosheetの動作原理

Mitosheetで操作を行うと、自動的にその操作に対応するPythonコードが生成されます。たとえば、特定の値のみを表示するために列をフィルタリングする場合、Mitosheetは同じ操作を実行するPandasのコードスニペットを生成します。このコードはMitosheetのすぐ下にあるJupyterのセルに表示され、実行したりプロジェクトに統合したりする準備ができています。

以下に簡単な例を示します。`df`という名前のデータフレームがあり、'Age'列の値が25未満の行をフィルタリングしたい場合、Mitosheetではインターフェースを使用してフィルタリングを適用するだけです。生成された対応するPythonコードは次のとおりです。

```python
df_filtered = df[df['Age'] >= 25]
```

この機能は、データ分析に精通しているがコーディングにあまり慣れていない人にとって特に便利です。これにより、ユーザーは自分の操作がPythonコードにどのように変換されるかを理解する助けを得ることができます。

スプレッドシートの簡易さとPythonのパワーを組み合わせたMitosheetは、データサイエンスのツールキットで自らの領域を切り開いています。探索的データ分析、データクリーニング、可視化を行う場合でも、Mitosheetは効率的な方法で作業を完了するためのスムーズな方法を提供します。

## Mitosheetのインストール方法

Mitosheetのインストールは簡単なプロセスであり、使用する環境に応じて複数の方法で行うことができます。最も一般的な方法はPythonのパッケージマネージャであるpipを使用する方法です。しかし、MitosheetはDockerコンテナやStreamlitアプリに直接インストールすることもできるため、柔軟性も提供しています。

### pipを使用してMitosheetをインストールする

Mitosheetを簡単に起動するための最もシンプルな方法は、Pythonのパッケージマネージャであるpipを使用することです。ターミナルを開き、次のコマンドを実行します。

```python
pip install mitoinstaller
```

インストールが完了したら、インストーラを実行する必要があります。

```python
python -m mitoinstaller install
```

このコマンドにより、MitosheetがクラシックなJupyterノートブックとJupyterLab 3.0の両方にインストールされます。プロセスは通常素早く完了しますが、システムによって所要時間が異なる場合があります。

### DockerコンテナでMitosheetをインストールする

Dockerは、アプリケーションのすべての依存関係をコンテナにパッケージ化し、配布および実行を容易にする方法を提供します。DockerコンテナでMitosheetをインストールすることで、すべての依存関係がきちんとカプセル化され、一貫性のある環境が提供されます。以下に手順を示します：
```dockerfile
RUN pip install notebook
```

4. **Mitosheetをインストール**: 以下のコマンドを追加してMitosheetをインストールします。
    ```dockerfile
    RUN pip install mitosheet
    ```

5. **Mitosheet拡張機能を有効にする**: 最後に、Jupyter NotebookでMitosheet拡張機能を有効にします。
    ```dockerfile
    RUN jupyter nbextension enable mitosheet --py --sys-prefix
    ```

6. **Dockerイメージをビルドする**: Dockerfileを保存し、以下のコマンドを使用してイメージをビルドします。
    ```bash
    docker build -t my-mitosheet-container .
    ```

7. **コンテナを実行する**: イメージがビルドされたら、以下を使用して実行します。
    ```bash
    docker run -p 8888:8888 my-mitosheet-container
    ```

### StreamlitアプリにMitosheetをインストールする

StreamlitはPythonでウェブアプリを作成するための人気のあるフレームワークです。Mitosheetを直接Streamlitアプリに統合して、データ操作の機能を活用することができます。以下の手順を実行してください。

1. **Streamlitをインストールする**: まだインストールしていない場合、pipを使用してStreamlitをインストールします。
    ```bash
    pip install streamlit
    ```

2. **Mitosheetをインストールする**: 以下のコマンドでMitosheetをインストールします。
    ```bash
    pip install mitosheet
    ```

3. **アプリにインポートする**: StreamlitアプリでMitosheetを以下のようにインポートします。
    ```python
    import mitosheet
    ```

4. **Mitosheetを初期化する**: Streamlitアプリ内でMitosheetを初期化するには、以下のコードを使用します。
    ```python
    mitosheet.sheet()
    ```

### Jupyter NotebookのためのMitosheet拡張機能のインストール

Jupyter Notebookを主に使用するデータサイエンティストや研究者の場合、Mitosheet拡張機能のインストールは簡単です。

1. **Mitosheetをインストールする**: ターミナルを開き、以下のコマンドを実行してMitosheetをインストールします。
    ```bash
    pip install mitosheet
    ```

2. **拡張機能を有効にする**: 以下のコマンドでJupyter NotebookのMitosheet拡張機能を有効にします。
    ```bash
    jupyter nbextension enable mitosheet --py --sys-prefix
    ```

3. **インストールの確認**: 新しいJupyterノートブックを開き、以下のPythonコードを実行してMitosheetを初期化します。
    ```python
    import mitosheet
    mitosheet.sheet()
    ```
   
## 最初のMitosheetを作成する

Mitosheetを正常にインストールした後は、次のステップは最初のMitosheetを作成し、その機能を体験することです。新しいMitosheetを作成するには、JupyterLabまたはStreamlitのインターフェースでボタンをクリックするだけです。

### Mitosheetへのデータのインポート

MitosheetはポイントアンドクリックのCSVおよびXLSXインポートをサポートしており、データをツールに簡単に取り込むことができます。以下の手順で行うことができます。

1. Mitosheetアイコンをクリックして新しいMitosheetを開きます。
2. 'Import'タブに移動します。
3. インポートしたいファイルを選択し、「Open」をクリックします。

データはスプレッドシートのようなインターフェースに表示され、操作の準備が整いました。

### Mitosheetでの基本操作

データがインポートされたら、さまざまな操作を行うことができます。

- **フィルタリングとソート**: 各列の上部にあるツールバーを使用して、簡単に列をフィルタリングやソートすることができます。
- **ピボットテーブル**：データの集計にExcel形式のピボットテーブルを作成することができます。
- **列操作**：列に対して基本的な計算や変換を行うことができます。

たとえば、'Age'という名前の列で平均年齢を計算したい場合、列を選択し、「Operations」タブに移動して「Average」を選択するだけです。Mitosheetは計算を実行するだけでなく、対応するPythonコードも生成します。

```python
average_age = df['Age'].mean()
```

最初のMitosheetを作成するのは簡単で、直感的なインターフェースにより、あなたの専門知識レベルに関係なくすぐに使い始めることができます。ポイントアンドクリックのデータインポートやデータ操作オプションなどの機能により、Mitosheetはデータ分析の作業フローをできるだけスムーズにするために設計されています。

既存のMitosheet仮想環境を開くには、次の手順に従ってください。

```bash
# 環境をアクティブにする
conda activate mitoenv

# Jupyter Labを起動する
jupyter lab
```

## Mitosheetでの関数の使用方法

Mitosheetは単なるスプレッドシートツールではありません。データ分析と操作に特化したさまざまな関数を提供する包括的なプラットフォームです。フィルタリングやソートなどの基本的な操作から、データ可視化などの高度な機能まで、Mitosheetにはすべてが備わっています。

### データ操作関数

Mitosheetはさまざまなデータ操作関数を提供しています。以下はそのいくつかの主な機能です。

- **列変換**: log、平方根、三角関数などの変換を列全体に適用することができます。
- **テキスト操作**: サブストリングの抽出、大文字小文字の変換、パターンマッチングなど、テキストの操作を直接Mitosheet内で行うことができます。
- **日付と時間関数**: 日付のパース、フォーマット、演算など、日付と時間データを容易に扱うことができます。

たとえば、「Purchse_Date」という名前の日付列から年を抽出したい場合、Mitosheetは次のようなPythonコードを生成します。

```python
df['Year'] = df['Purchase_Date'].dt.year
```

### Mitosheetでのデータ可視化

Mitosheetの特色の1つはデータ可視化の機能です。ツール内でさまざまなチャートやグラフを作成することができます。

- **棒グラフ**
- **折れ線グラフ**
- **円グラフ**
- **散布図**

データを選択し、グラフのタイプを選択すれば、簡単にチャートを作成することができます。MitosheetはMatplotlibやSeabornなどのライブラリを使用してPythonコードも生成します。

![MitoSheet Create Graph](https://github.com/lynn-mikami/Images/blob/main/mitosheet-create-graph.png?raw=true)

### 高度な機能

Mitosheetには、より複雑なデータ分析タスクに非常に役立ついくつかの高度な機能も用意されています。

- **結合操作**: 異なるデータフレーム間でSQLのような結合を行うことができます。
- **グループ化と集計**: 特定の列に基づいてデータを集計するための「Group By」機能を使用します。
例えば、各製品カテゴリの総売上を求めたい場合、'Category'列をグループ化して'Sales'列を合計する 'Group By'操作を行います。生成されるPythonコードは、次のようになります:

```python
df_grouped = df.groupby('Category')['Sales'].sum().reset_index()
```

Mitosheetは、基本的なデータ操作から高度なデータ操作までをカバーする多機能なツールとして、データサイエンスのツールキットでの使い方に対応しています。各操作ごとにPythonコードを生成することで、自分の作業を大規模なプロジェクトに統合しやすくするだけでなく、これらの操作がプログラムでどのように実行されるかを理解するための学習ツールとしても役立ちます。

## Mitosheet AIを使用したスプレッドシート用の自動生成Pythonコード

Mitosheetは、データの操作だけでなく、 AI機能を組み込んだ静的なツールではありません。これらのAI機能は、繰り返しのタスクを自動化し、ワークフローをより効率的にするために設計されています。

Mitosheetスプレッドシートへの各編集は自動的にPythonコードを生成します。既存のツールを使って自分の手に自動化を持ち込みましょう。以下をチェックしてください👇

### オートサジェストと予測分析

Mitosheetの最もエキサイティングなAI機能の1つは、データに基づいて自動的にサジェストを提供する能力です。 たとえば、売上、収益、顧客評価などのさまざまなメトリックを含むデータセットで作業している場合、Mitosheetは、分析に役立つ関連する可視化や統計的なテストを自動的に提案することができます。

### 異常検出

もう1つの強力なAI機能は異常検出です。データセットに外れ値や異常が含まれている場合、Mitosheetはこれらを自動的に検出します。これは、詐欺検出や品質管理など、異常を迅速に特定する必要があるシナリオで特に役立ちます。

### データクリーニングの自動化

データクリーニングは、データ分析プロセスの中で最も時間のかかる部分です。 MitosheetのAI機能を使用すると、データクリーニングの多くの側面を自動化することができます。欠損値の処理からデータ型の修正まで、Mitosheetがすべてを処理してくれるため、貴重な時間を節約できます。

たとえば、欠損値のある列がある場合、Mitosheetは列の平均値、中央値、またはモードに基づいてこれを自動的に埋めることができます。生成されるPythonコードは、次のようなものになるかもしれません:

```python
df['Column_Name'].fillna(df['Column_Name'].mean(), inplace=True)
```

AIをコア機能に統合することにより、Mitosheetは単なるスプレッドシートツールを超えて、データ分析の旅をサポートするスマートアシスタントとなり、進行中の作業に沿って推奨をしたり、タスクを自動化したりすることができます。

## Mitosheetで生成されたコードの使用方法

Mitosheetの最も魅力的な機能の1つは、ツール内で行ったすべての操作に対してPythonコードを生成できることです。このコードは単なる副産物ではなく、さまざまな方法で利用できる貴重な資産です。

### Jupyterノートブックへのコードの統合

Mitosheetで行った操作は、自動的にPythonコードに変換されて、Mitosheetの下にあるJupyterセルに表示されます。このコードはノートブック内で直接実行することができ、結果を即座に確認することができます。

### 再利用性と協力

生成されるコードは非常に再利用可能です。簡単に他のPythonスクリプトやJupyterノートブックにコピーすることができます。これは、データ変換のステップをチームメンバーと共有する必要がある共同プロジェクトに特に役立ちます。

たとえば、Mitosheetでデータフレームをフィルタリングしてソートした場合、生成されるコードは、同様のデータセットに同じ変換を適用することができる同僚と共有できます。コードは次のようになるかもしれません:

```python
df_filtered_sorted = df[df['Age'] > 25].sort_values(by='Salary', ascending=False)
```

## Mitosheetの代替ツール

Mitoは、スプレッドシートのようなインターフェースとデータ分析用のPythonコード生成のユニークな組み合わせを提供する一方で、他のツールやライブラリも考慮することができます:

1. **PandasGUI**: パンダのデータフレームのGUIを提供するPythonライブラリです。簡単なデータ操作が可能ですが、アクティビティに基づいてPythonコードを生成しません。

2. **DataPrep**: データの準備プロセスを簡素化することを目指すPythonライブラリで、クリーニング、可視化、データの理解などさまざまな機能を提供しています。

3. **Jupyter Widgets**: Jupyterノートブック用の対話型ウィジェットです。直接的な代替ではありませんが、Jupyterノートブックでのデータ分析のための対話型ダッシュボードの作成に使用することができます。

4. **Tableau**: データの可視化ツールとしてよく知られており、いくつかのデータ操作も可能です。Pythonベースではありませんが、堅牢な機能を提供しています。

5. **Excel Power Query**: Excelに精通しているユーザー向けに、データ変換用のGUIを含むデータ操作の範囲を提供しています。

import FeedFetcher from '../../components/feed-fetcher';
import { Cards, Card } from 'nextra/components';

<FeedFetcher feedPath="/feed-ja.xml" folderFilter="/ai-tools/" render={articles => (
    <>
        <Cards>
            {articles.slice(0, 9).map(article => (
                <Card key={article.link} title={article.title} href={article.link} />
            ))}
        </Cards>
    </>
)} />
